# Git å·¥ä½œæµè§„èŒƒ

> æœ¬æ–‡æ¡£å®šä¹‰äº† CodeHubot é¡¹ç›®çš„ Git ä½¿ç”¨è§„èŒƒï¼ŒåŒ…æ‹¬æäº¤ä¿¡æ¯ã€åˆ†æ”¯ç®¡ç†å’Œåä½œæµç¨‹ã€‚

## ğŸ“‹ ç›®å½•

- [æäº¤ä¿¡æ¯è§„èŒƒ](#æäº¤ä¿¡æ¯è§„èŒƒ)
- [åˆ†æ”¯ç®¡ç†ç­–ç•¥](#åˆ†æ”¯ç®¡ç†ç­–ç•¥)
- [æäº¤æµç¨‹](#æäº¤æµç¨‹)
- [ä»£ç å®¡æŸ¥](#ä»£ç å®¡æŸ¥)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## ğŸ“ æäº¤ä¿¡æ¯è§„èŒƒ

### 1. æäº¤ä¿¡æ¯æ ¼å¼

ä½¿ç”¨ **Conventional Commits** è§„èŒƒï¼š

```bash
<type>(<scope>): <subject>

<body>

<footer>
```

#### ç®€åŒ–æ ¼å¼ï¼ˆæ¨èï¼‰

```bash
<type>(<scope>): <subject>

# ç¤ºä¾‹:
feat(pbl): æ·»åŠ è¯¾ç¨‹æ¨¡æ¿æƒé™ç®¡ç†åŠŸèƒ½
fix(api): ä¿®å¤ç”¨æˆ·ç™»å½•tokenè¿‡æœŸé—®é¢˜
docs(readme): æ›´æ–°éƒ¨ç½²æ–‡æ¡£
```

### 2. Type ç±»å‹

| Type | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **feat** | æ–°åŠŸèƒ½ | feat(pbl): æ·»åŠ è¯¾ç¨‹æ¨¡æ¿ç®¡ç† |
| **fix** | ä¿®å¤bug | fix(api): ä¿®å¤åˆ†é¡µæŸ¥è¯¢é”™è¯¯ |
| **docs** | æ–‡æ¡£æ›´æ–° | docs(api): æ›´æ–°APIæ¥å£æ–‡æ¡£ |
| **style** | ä»£ç æ ¼å¼è°ƒæ•´ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰ | style(vue): ç»Ÿä¸€ä»£ç ç¼©è¿›æ ¼å¼ |
| **refactor** | é‡æ„ï¼ˆä¸æ˜¯æ–°åŠŸèƒ½ä¹Ÿä¸æ˜¯ä¿®å¤bugï¼‰ | refactor(auth): ä¼˜åŒ–æƒé™æ£€æŸ¥é€»è¾‘ |
| **perf** | æ€§èƒ½ä¼˜åŒ– | perf(query): ä¼˜åŒ–è¯¾ç¨‹åˆ—è¡¨æŸ¥è¯¢ |
| **test** | æµ‹è¯•ç›¸å…³ | test(api): æ·»åŠ è¯¾ç¨‹APIæµ‹è¯• |
| **chore** | æ„å»º/å·¥å…·é“¾ç›¸å…³ | chore(deps): å‡çº§ä¾èµ–åŒ…ç‰ˆæœ¬ |
| **revert** | å›æ»šæäº¤ | revert: å›æ»šfeat(pbl): xxx |

### 3. Scope èŒƒå›´

å¸¸ç”¨çš„ scope:

```bash
# åç«¯æ¨¡å—
api         # API æ¥å£
pbl         # PBL æ¨¡å—
auth        # è®¤è¯æ¨¡å—
device      # è®¾å¤‡æ¨¡å—
ai          # AI æ¨¡å—
db          # æ•°æ®åº“

# å‰ç«¯æ¨¡å—
vue         # Vue ç»„ä»¶
router      # è·¯ç”±
ui          # UI ç»„ä»¶
style       # æ ·å¼

# å…¶ä»–
docs        # æ–‡æ¡£
config      # é…ç½®
deploy      # éƒ¨ç½²
sql         # SQL è„šæœ¬
```

### 4. Subject ä¸»é¢˜

- ä½¿ç”¨ä¸­æ–‡æè¿°ï¼ˆæ¸…æ™°æ˜“æ‡‚ï¼‰
- ç®€æ´æ˜äº†ï¼ˆä¸è¶…è¿‡ 50 å­—ç¬¦ï¼‰
- ä¸ä»¥å¥å·ç»“å°¾
- ä½¿ç”¨ç¥ˆä½¿å¥ï¼ˆ"æ·»åŠ "è€Œä¸æ˜¯"å·²æ·»åŠ "ï¼‰

#### âœ… å¥½çš„ç¤ºä¾‹

```bash
feat(pbl): æ·»åŠ è¯¾ç¨‹æ¨¡æ¿æƒé™ç®¡ç†åŠŸèƒ½
fix(api): ä¿®å¤ç”¨æˆ·ç™»å½•tokenè¿‡æœŸå¯¼è‡´çš„401é”™è¯¯
docs(readme): æ›´æ–°Dockeréƒ¨ç½²è¯´æ˜
refactor(auth): ç®€åŒ–æƒé™æ£€æŸ¥é€»è¾‘
perf(query): ä¼˜åŒ–è¯¾ç¨‹åˆ—è¡¨æŸ¥è¯¢æ€§èƒ½
```

#### âŒ ä¸å¥½çš„ç¤ºä¾‹

```bash
update code                           # å¤ªæ¨¡ç³Š
ä¿®å¤bug                               # æ²¡æœ‰å…·ä½“è¯´æ˜
feat: æ·»åŠ äº†ä¸€ä¸ªæ–°åŠŸèƒ½ç”¨äºè¯¾ç¨‹æ¨¡æ¿ç®¡ç†  # å¤ªé•¿
Fix Bug.                              # è‹±æ–‡ä¸è§„èŒƒï¼Œæœ‰å¥å·
```

### 5. Body æ­£æ–‡ï¼ˆå¯é€‰ï¼‰

è¯¦ç»†è¯´æ˜ä¿®æ”¹å†…å®¹ã€åŸå› å’Œå½±å“ï¼š

```bash
feat(pbl): æ·»åŠ è¯¾ç¨‹æ¨¡æ¿æƒé™ç®¡ç†åŠŸèƒ½

- æ–°å¢æ¨¡æ¿æƒé™è¡¨ pbl_template_school_permissions
- å®ç°å¹³å°ç®¡ç†å‘˜åˆ†é…æ¨¡æ¿æƒé™ç»™å­¦æ ¡
- å­¦æ ¡ç®¡ç†å‘˜å¯æŸ¥çœ‹å¯ç”¨æ¨¡æ¿åˆ—è¡¨
- æ”¯æŒæŒ‰éš¾åº¦ã€ç±»åˆ«ç­›é€‰æ¨¡æ¿

æ•°æ®åº“å˜æ›´: SQL/update/32_add_template_permissions.sql
```

### 6. Footer è„šæ³¨ï¼ˆå¯é€‰ï¼‰

ç”¨äºå…³è” Issue æˆ–æ ‡æ³¨ Breaking Changesï¼š

```bash
fix(api): ä¿®å¤åˆ†é¡µæŸ¥è¯¢bug

ä¿®å¤äº†æŸ¥è¯¢å‚æ•°éªŒè¯é€»è¾‘

Closes #123
Fixes #456

# Breaking Change ç¤ºä¾‹
feat(api): é‡æ„APIå“åº”æ ¼å¼

BREAKING CHANGE: æ‰€æœ‰APIå“åº”æ ¼å¼æ”¹ä¸ºç»Ÿä¸€æ ¼å¼ {code, message, data}
```

---

## ğŸŒ² åˆ†æ”¯ç®¡ç†ç­–ç•¥

### 1. ä¸»åˆ†æ”¯

```bash
main (æˆ– master)
â”œâ”€â”€ ç”Ÿäº§ç¯å¢ƒä»£ç 
â”œâ”€â”€ å—ä¿æŠ¤åˆ†æ”¯ï¼ˆä¸èƒ½ç›´æ¥æäº¤ï¼‰
â””â”€â”€ æ‰€æœ‰åŠŸèƒ½æœ€ç»ˆåˆå¹¶åˆ°è¿™é‡Œ
```

### 2. ç®€åŒ–çš„åˆ†æ”¯ç­–ç•¥

ç”±äºé¡¹ç›®è§„æ¨¡å’Œå›¢é˜Ÿç‰¹ç‚¹ï¼Œå»ºè®®ä½¿ç”¨ç®€åŒ–çš„åˆ†æ”¯ç­–ç•¥ï¼š

#### æ–¹å¼ 1: ç›´æ¥åœ¨ main å¼€å‘ï¼ˆå°å›¢é˜Ÿï¼‰

```bash
# é€‚ç”¨åœºæ™¯: 1-3äººå›¢é˜Ÿï¼Œå¼€å‘èŠ‚å¥å¿«

# 1. æ›´æ–°ä»£ç 
git pull origin main

# 2. å¼€å‘å’Œæäº¤
git add .
git commit -m "feat(pbl): æ·»åŠ æ–°åŠŸèƒ½"

# 3. æ¨é€
git push origin main
```

#### æ–¹å¼ 2: ä¸´æ—¶åŠŸèƒ½åˆ†æ”¯ï¼ˆæ¨èï¼‰

```bash
# é€‚ç”¨åœºæ™¯: å¤šäººåä½œï¼ŒåŠŸèƒ½å¼€å‘æ—¶é—´è¾ƒé•¿

# 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feat/template-permissions

# 2. å¼€å‘å’Œæäº¤
git add .
git commit -m "feat(pbl): æ·»åŠ æ¨¡æ¿æƒé™ç®¡ç†"

# 3. æ¨é€åˆ°è¿œç¨‹
git push origin feat/template-permissions

# 4. åˆå¹¶åˆ° mainï¼ˆæœ¬åœ°æˆ–é€šè¿‡ PRï¼‰
git checkout main
git pull origin main
git merge feat/template-permissions
git push origin main

# 5. åˆ é™¤åŠŸèƒ½åˆ†æ”¯
git branch -d feat/template-permissions
git push origin --delete feat/template-permissions
```

### 3. åˆ†æ”¯å‘½åè§„èŒƒ

```bash
# åŠŸèƒ½åˆ†æ”¯
feat/template-permissions     # æ–°åŠŸèƒ½
feat/course-analytics         # æ–°åŠŸèƒ½

# ä¿®å¤åˆ†æ”¯
fix/login-token-expire        # bugä¿®å¤
fix/pagination-error          # bugä¿®å¤

# é‡æ„åˆ†æ”¯
refactor/auth-system          # ä»£ç é‡æ„

# æ–‡æ¡£åˆ†æ”¯
docs/api-specification        # æ–‡æ¡£æ›´æ–°

# ç¤ºä¾‹:
git checkout -b feat/student-portfolio
git checkout -b fix/course-list-pagination
git checkout -b docs/development-guide
```

---

## ğŸ”„ æäº¤æµç¨‹

### 1. æ—¥å¸¸å¼€å‘æµç¨‹

```bash
# 1. æ›´æ–°æœ¬åœ°ä»£ç 
git checkout main
git pull origin main

# 2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼ˆå¯é€‰ï¼Œå¤æ‚åŠŸèƒ½æ¨èï¼‰
git checkout -b feat/new-feature

# 3. å¼€å‘å’Œæµ‹è¯•
# ... ç¼–å†™ä»£ç  ...

# 4. æŸ¥çœ‹ä¿®æ”¹
git status
git diff

# 5. æš‚å­˜ä¿®æ”¹
git add .
# æˆ–é€‰æ‹©æ€§æ·»åŠ 
git add backend/app/api/pbl/templates.py
git add frontend/src/modules/pbl/views/Templates.vue

# 6. æäº¤
git commit -m "feat(pbl): æ·»åŠ è¯¾ç¨‹æ¨¡æ¿ç®¡ç†åŠŸèƒ½"

# 7. æ¨é€
git push origin feat/new-feature
# æˆ–ç›´æ¥æ¨é€åˆ° main
git push origin main

# 8. åˆå¹¶åˆ° mainï¼ˆå¦‚æœä½¿ç”¨äº†åŠŸèƒ½åˆ†æ”¯ï¼‰
git checkout main
git merge feat/new-feature
git push origin main

# 9. åˆ é™¤åŠŸèƒ½åˆ†æ”¯
git branch -d feat/new-feature
```

### 2. æäº¤å‰æ£€æŸ¥æ¸…å•

```bash
# âœ… æäº¤å‰å¿…é¡»æ£€æŸ¥:

# 1. ä»£ç æ ¼å¼æ­£ç¡®
# 2. æ²¡æœ‰è¯­æ³•é”™è¯¯
# 3. æ²¡æœ‰ console.log ç­‰è°ƒè¯•ä»£ç 
# 4. æ²¡æœ‰ç¡¬ç¼–ç çš„æ•æ„Ÿä¿¡æ¯
# 5. API ä½¿ç”¨ç»Ÿä¸€å“åº”æ ¼å¼
# 6. æ•°æ®åº“å˜æ›´å·²ç”Ÿæˆ SQL è„šæœ¬
# 7. æäº¤ä¿¡æ¯ç¬¦åˆè§„èŒƒ
# 8. ä¸åŒ…å«æ— å…³çš„æ–‡ä»¶ä¿®æ”¹

# æŸ¥çœ‹å°†è¦æäº¤çš„å†…å®¹
git diff --staged
```

### 3. ä¿®æ”¹æäº¤ä¿¡æ¯

```bash
# ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤ä¿¡æ¯
git commit --amend -m "feat(pbl): ä¿®æ­£åçš„æäº¤ä¿¡æ¯"

# ä¿®æ”¹å¤šæ¬¡æäº¤ï¼ˆäº¤äº’å¼rebaseï¼‰
git rebase -i HEAD~3  # ä¿®æ”¹æœ€è¿‘3æ¬¡æäº¤

# âš ï¸ æ³¨æ„: ä¸è¦ä¿®æ”¹å·²ç»æ¨é€çš„æäº¤
```

### 4. æ’¤é”€æ“ä½œ

```bash
# æ’¤é”€å·¥ä½œåŒºä¿®æ”¹ï¼ˆæœª addï¼‰
git checkout -- filename

# æ’¤é”€æš‚å­˜åŒºä¿®æ”¹ï¼ˆå·² addï¼Œæœª commitï¼‰
git reset HEAD filename

# æ’¤é”€æäº¤ï¼ˆå·² commitï¼Œæœª pushï¼‰
git reset --soft HEAD~1     # ä¿ç•™ä¿®æ”¹
git reset --hard HEAD~1     # ä¸¢å¼ƒä¿®æ”¹

# æ’¤é”€æ¨é€çš„æäº¤ï¼ˆå·² pushï¼‰
git revert <commit-hash>    # åˆ›å»ºæ–°æäº¤æ¥æ’¤é”€
```

---

## ğŸ‘¥ ä»£ç å®¡æŸ¥

### 1. Pull Request æµç¨‹ï¼ˆå¯é€‰ï¼‰

```bash
# 1. æ¨é€åŠŸèƒ½åˆ†æ”¯
git push origin feat/new-feature

# 2. åœ¨ GitHub/GitLab åˆ›å»º PR
# - å¡«å†™ PR æ ‡é¢˜å’Œæè¿°
# - å…³è”ç›¸å…³ Issue
# - è¯·æ±‚ä»£ç å®¡æŸ¥

# 3. ä»£ç å®¡æŸ¥
# - å®¡æŸ¥è€…æ£€æŸ¥ä»£ç è´¨é‡
# - æå‡ºä¿®æ”¹å»ºè®®
# - è®¨è®ºå®ç°æ–¹æ¡ˆ

# 4. ä¿®æ”¹å’Œæ›´æ–°
git add .
git commit -m "fix: æ ¹æ®å®¡æŸ¥æ„è§ä¿®æ”¹"
git push origin feat/new-feature

# 5. åˆå¹¶ PR
# - å®¡æŸ¥é€šè¿‡ååˆå¹¶åˆ° main
# - åˆ é™¤åŠŸèƒ½åˆ†æ”¯
```

### 2. ä»£ç å®¡æŸ¥é‡ç‚¹

```markdown
# ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•:

## åŠŸèƒ½æ€§
- [ ] å®ç°äº†éœ€æ±‚çš„åŠŸèƒ½
- [ ] æ²¡æœ‰æ˜æ˜¾çš„ bug
- [ ] è¾¹ç•Œæƒ…å†µå¤„ç†æ­£ç¡®

## ä»£ç è´¨é‡
- [ ] ä»£ç é€»è¾‘æ¸…æ™°æ˜“æ‡‚
- [ ] å‘½åè§„èŒƒï¼Œè§åçŸ¥æ„
- [ ] æ²¡æœ‰é‡å¤ä»£ç 
- [ ] å‡½æ•°èŒè´£å•ä¸€

## è§„èŒƒæ€§
- [ ] ç¬¦åˆä»£ç é£æ ¼è§„èŒƒ
- [ ] API ä½¿ç”¨ç»Ÿä¸€å“åº”æ ¼å¼
- [ ] é”™è¯¯å¤„ç†å®Œæ•´
- [ ] æœ‰å¿…è¦çš„æ³¨é‡Š

## å®‰å…¨æ€§
- [ ] æ²¡æœ‰ SQL æ³¨å…¥é£é™©
- [ ] æ²¡æœ‰ XSS é£é™©
- [ ] æ•æ„Ÿä¿¡æ¯å·²åŠ å¯†
- [ ] æƒé™æ£€æŸ¥å®Œæ•´

## æ€§èƒ½
- [ ] æ²¡æœ‰æ˜æ˜¾æ€§èƒ½é—®é¢˜
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- [ ] åˆç†ä½¿ç”¨ç´¢å¼•
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æäº¤ç²’åº¦

```bash
# âœ… å¥½çš„æäº¤: ä¸€ä¸ªæäº¤åªåšä¸€ä»¶äº‹
git commit -m "feat(pbl): æ·»åŠ è¯¾ç¨‹æ¨¡æ¿åˆ—è¡¨API"
git commit -m "feat(pbl): æ·»åŠ æ¨¡æ¿è¯¦æƒ…API"
git commit -m "style(pbl): ä¼˜åŒ–æ¨¡æ¿åˆ—è¡¨é¡µé¢æ ·å¼"

# âŒ ä¸å¥½çš„æäº¤: ä¸€ä¸ªæäº¤åšå¤šä»¶äº‹
git commit -m "æ·»åŠ è¯¾ç¨‹æ¨¡æ¿åŠŸèƒ½å¹¶ä¿®å¤ç™»å½•bug"  # åº”è¯¥æ‹†åˆ†
```

### 2. æäº¤é¢‘ç‡

```bash
# âœ… æ¨è: å®Œæˆä¸€ä¸ªå°åŠŸèƒ½å°±æäº¤
# - æ·»åŠ ä¸€ä¸ª API æ¥å£
# - å®Œæˆä¸€ä¸ªé¡µé¢
# - ä¿®å¤ä¸€ä¸ª bug

# âŒ é¿å…: 
# - å‡ å¤©ä¸æäº¤ï¼Œä¸€æ¬¡æ€§æäº¤å¤§é‡ä»£ç 
# - æ¯æ”¹ä¸€è¡Œå°±æäº¤
```

### 3. åˆ†æ”¯ç®¡ç†

```bash
# âœ… åŠæ—¶åˆ é™¤å·²åˆå¹¶çš„åˆ†æ”¯
git branch -d feat/old-feature
git push origin --delete feat/old-feature

# âœ… ä¿æŒåˆ†æ”¯ç®€æ´
git branch  # å®šæœŸæŸ¥çœ‹æœ¬åœ°åˆ†æ”¯
git branch -a  # æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ˆåŒ…æ‹¬è¿œç¨‹ï¼‰

# âŒ é¿å…åˆ†æ”¯è¿‡å¤šå¯¼è‡´æ··ä¹±
# é¡¹ç›®è¦æ±‚: ä¸è¦åˆ›å»ºå¤ªå¤šé•¿æœŸåˆ†æ”¯
```

### 4. å†²çªè§£å†³

```bash
# æ›´æ–°ä»£ç æ—¶é‡åˆ°å†²çª
git pull origin main

# æ‰‹åŠ¨è§£å†³å†²çª
# 1. ç¼–è¾‘å†²çªæ–‡ä»¶
# 2. åˆ é™¤å†²çªæ ‡è®° (<<<<, ====, >>>>)
# 3. æµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸

# æ ‡è®°å†²çªå·²è§£å†³
git add .
git commit -m "fix: è§£å†³åˆå¹¶å†²çª"

# æ¨é€
git push origin main
```

### 5. .gitignore è§„èŒƒ

```bash
# Python
__pycache__/
*.py[cod]
*.so
.env
venv/
*.log

# Node.js
node_modules/
dist/
.DS_Store

# IDE
.vscode/
.idea/
*.swp

# é¡¹ç›®ç‰¹å®š
logs/
uploads/
*.db
```

---

## ğŸš¨ æ³¨æ„äº‹é¡¹

### 1. ç¦æ­¢æ“ä½œ

```bash
# âŒ ç¦æ­¢: ç›´æ¥ä¿®æ”¹å·²æ¨é€çš„å†å²è®°å½•
git push -f origin main  # å±é™©ï¼ä¼šè¦†ç›–ä»–äººä»£ç 

# âŒ ç¦æ­¢: æäº¤æ•æ„Ÿä¿¡æ¯
git add .env             # åŒ…å«å¯†ç ã€å¯†é’¥
git add config.py        # åŒ…å«æ•æ„Ÿé…ç½®

# âŒ ç¦æ­¢: æäº¤å¤§æ–‡ä»¶
git add large-file.zip   # è¶…è¿‡ 100MB

# âŒ ç¦æ­¢: æäº¤ä¸´æ—¶æ–‡ä»¶
git add *.log
git add __pycache__/
```

### 2. ä¿æŠ¤æªæ–½

```bash
# æ£€æŸ¥å°†è¦æäº¤çš„æ–‡ä»¶
git status
git diff --staged

# ç§»é™¤è¯¯æ·»åŠ çš„æ–‡ä»¶
git reset HEAD .env

# åˆ é™¤ Git å†å²ä¸­çš„æ•æ„Ÿæ–‡ä»¶
git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch .env" \
  --prune-empty --tag-name-filter cat -- --all
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [Conventional Commits è§„èŒƒ](https://www.conventionalcommits.org/)
- [Git å®˜æ–¹æ–‡æ¡£](https://git-scm.com/doc)
- [GitHub Flow](https://guides.github.com/introduction/flow/)
- é¡¹ç›®æ–‡æ¡£: `GIT_WORKFLOW.md`

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# æŸ¥çœ‹çŠ¶æ€
git status

# æŸ¥çœ‹æ—¥å¿—
git log --oneline --graph --all

# æŸ¥çœ‹æŸä¸ªæ–‡ä»¶çš„ä¿®æ”¹å†å²
git log -p filename

# æŸ¥çœ‹æŸæ¬¡æäº¤çš„è¯¦æƒ…
git show <commit-hash>

# æŸ¥çœ‹è¿œç¨‹ä»“åº“
git remote -v

# æ›´æ–°è¿œç¨‹åˆ†æ”¯åˆ—è¡¨
git fetch --prune

# æ¸…ç†æœ¬åœ°å·²åˆ é™¤çš„è¿œç¨‹åˆ†æ”¯
git remote prune origin

# æŸ¥çœ‹é…ç½®
git config --list
```

---

**è®°ä½**: è§„èŒƒçš„ Git ä½¿ç”¨ä¹ æƒ¯è®©å›¢é˜Ÿåä½œæ›´é¡ºç•…ï¼Œä»£ç å†å²æ›´æ¸…æ™°ï¼
