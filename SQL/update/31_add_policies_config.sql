-- ==========================================================================================================
-- 用户协议和隐私政策配置脚本
-- ==========================================================================================================
-- 脚本名称: 31_add_policies_config.sql
-- 脚本版本: 1.0.0
-- 创建日期: 2025-12-19
-- 兼容版本: MySQL 5.7.x, 8.0.x
-- 字符集: utf8mb4
-- 排序规则: utf8mb4_unicode_ci
--
-- ==========================================================================================================
-- 脚本说明
-- ==========================================================================================================
--
-- 1. 用途说明:
--    在系统配置表中添加用户协议和隐私政策配置项
--    - user_agreement: 用户协议内容（支持HTML）
--    - privacy_policy: 隐私政策内容（支持HTML）
--
-- 2. 功能特性:
--    - 可重复执行（使用 INSERT IGNORE）
--    - 不依赖存储过程
--    - 兼容 MySQL 5.7/8.0
--
-- 3. 执行方式:
--    mysql -h hostname -u username -p --default-character-set=utf8mb4 aiot_admin < 31_add_policies_config.sql
--
-- ==========================================================================================================

-- 设置字符集
SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 显示当前数据库
SELECT '========================================' AS '';
SELECT CONCAT('当前数据库: ', DATABASE()) AS '';
SELECT '开始添加用户协议和隐私政策配置...' AS '';
SELECT '========================================' AS '';

-- ==========================================================================================================
-- 添加用户协议和隐私政策配置项
-- ==========================================================================================================

-- 用户协议配置
INSERT IGNORE INTO `core_system_config` (
    `config_key`,
    `config_value`,
    `config_type`,
    `description`,
    `category`,
    `is_public`
) VALUES (
    'user_agreement',
    '',
    'text',
    '用户协议内容',
    'policy',
    1
);

-- 隐私政策配置
INSERT IGNORE INTO `core_system_config` (
    `config_key`,
    `config_value`,
    `config_type`,
    `description`,
    `category`,
    `is_public`
) VALUES (
    'privacy_policy',
    '',
    'text',
    '隐私政策内容',
    'policy',
    1
);

-- 显示结果
SELECT '========================================' AS '';
SELECT '用户协议和隐私政策配置添加完成！' AS '';
SELECT '========================================' AS '';

-- 显示已添加的配置
SELECT 
    `config_key` AS '配置键',
    LENGTH(`config_value`) AS '内容长度',
    `description` AS '描述',
    `category` AS '分类',
    `is_public` AS '是否公开'
FROM `core_system_config`
WHERE `config_key` IN (
    'user_agreement',
    'privacy_policy'
)
ORDER BY `config_key`;

-- ==========================================================================================================
-- 脚本执行完成
-- ==========================================================================================================
